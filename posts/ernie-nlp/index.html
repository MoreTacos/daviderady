<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Even though ERNIE 2.0 came out for what feels in ML like a long time ago, it’s still an excellent model to look at to understand the larger context of NLP.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>An Intuitive Explanation of NLP Model ERNIE 2.0 &ndash; Davide Radaelli</title>
  <link rel="icon" href="/favicon-32.png" type="image/png" sizes="32x32">
  <link rel="icon" href="/favicon-192.png" type="image/png" sizes="192x192">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="preload" href="/fonts/chivo-normal-latin.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/opensans-latin.woff2" as="font" type="font/woff2" crossorigin>
  <style>@font-face{font-family:'Chivo';font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/chivo-normal-latin.woff2) format('woff2');}@font-face{font-family:'Chivo';font-style:italic;font-weight:400;font-display:swap;src:url(/fonts/chivo-italic-latin.woff2) format('woff2');}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400 700;font-stretch:100%;font-display:swap;src:url(/fonts/opensans-latin.woff2) format('woff2');}*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}:root{--color-primary:#000000;--color-secondary:#007cba;--color-foreground:#333333;--color-foreground-low-contrast:#444444;--color-background:#FFFFFF;--color-tertiary:#FAFAFA;--color-border:#EFEFEF;--font-heading:Chivo,"Playfair Display",Georgia,Times,serif;--font-body:"Open Sans","Fira Sans",Helvetica,Arial,sans-serif;--content-width:620px;--spacing-unit:20px;--spacing-horizontal:25px;--spacing-vertical:30px;}html{scrollbar-gutter:stable}body{font-family:var(--font-body);font-size:18px;font-weight:normal;color:var(--color-foreground);background:var(--color-background);line-height:1.7;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}a{color:var(--color-primary);text-decoration:underline;text-decoration-color:var(--color-secondary);text-decoration-thickness:1px;text-underline-offset:2px;}a:hover{color:var(--color-secondary);}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);font-weight:normal;line-height:1.3;color:var(--color-primary);margin:0;padding:0;}h1{font-size:48px;}h2{font-size:32px;}h3{font-size:28px;}h4{font-size:24px;}nav{display:flex;align-items:center;gap:0.5em;padding:var(--spacing-vertical) calc(2 * var(--spacing-horizontal));flex-wrap:wrap;max-width:var(--content-width);margin:0 auto;}nav a{color:var(--color-primary);font-family:var(--font-body);font-size:16px;font-weight:normal;text-decoration:none;padding:0 0.4em;}nav a:hover{color:var(--color-secondary);text-decoration:none;}nav .social-icons{display:flex;align-items:center;gap:0.4em;margin-left:0.2em;}nav .social-icons a{display:flex;align-items:center;padding:0;line-height:0;}nav .social-icons a[aria-label="Twitter"]{color:#1DA1F2;}nav .social-icons a[aria-label="YouTube"]{color:#FF0000;}nav .social-icons a:hover{color:var(--color-secondary);transform:scale(1.1);}nav .social-icons svg{width:24px;height:24px;fill:currentColor;}.home-content{display:flex;flex-wrap:nowrap;gap:2em;max-width:var(--content-width);margin:0 auto;padding:0 calc(2 * var(--spacing-horizontal));}.home-content .col-image{flex:0 0 33.33%;}.home-content .col-image img{width:100%;height:auto;display:block;}.home-content .col-text{flex:0 0 66.67%;max-width:66.67%;}.home-content .col-text h1{margin-bottom:calc(0.666 * var(--spacing-vertical));}.home-content .col-text p{margin-top:calc(0.666 * var(--spacing-vertical));margin-bottom:calc(0.666 * var(--spacing-vertical));}.page{max-width:var(--content-width);margin:0 auto;padding:0 calc(2 * var(--spacing-horizontal)) var(--spacing-vertical);}.page-header{margin-bottom:calc(0.666 * var(--spacing-vertical));}.page-header .meta{color:var(--color-foreground-low-contrast);font-family:var(--font-heading);font-size:14px;}.page-body > *{margin-top:calc(0.666 * var(--spacing-vertical));margin-bottom:calc(0.666 * var(--spacing-vertical));}.page-body h2{font-family:var(--font-heading);font-size:32px;font-weight:normal;line-height:1.3;color:var(--color-primary);}.page-body h3{font-family:var(--font-heading);font-size:28px;font-weight:normal;line-height:1.3;color:var(--color-primary);}.page-body h4{font-family:var(--font-heading);font-size:24px;font-weight:normal;line-height:1.3;color:var(--color-primary);}.page-body ul,.page-body ol{font-family:var(--font-body);padding-left:calc(2 * var(--spacing-horizontal));}.page-body ul{list-style-type:disc;}.page-body ol{list-style-type:decimal;}.page-body li{margin-top:calc(0.25 * var(--spacing-vertical));margin-bottom:calc(0.25 * var(--spacing-vertical));}.page-body blockquote{border-left:1px solid var(--color-secondary);padding:0;padding-left:calc(2 * var(--spacing-horizontal));margin:calc(0.666 * var(--spacing-vertical)) 0;font-family:var(--font-body);font-style:normal;}.page-body img{max-width:100%;height:auto;}.page-body figure{margin:calc(0.666 * var(--spacing-vertical)) 0;}.page-body figure img{max-width:100%;height:auto;display:block;margin:0 auto;}.page-body figcaption{color:var(--color-foreground-low-contrast);font-size:14px;line-height:1.7;margin-top:calc(0.5 * var(--spacing-unit));text-align:center;}.page-body code{font-family:monospace,monospace;font-size:1em;}.page-body pre{font-family:monospace,monospace;font-size:1em;overflow:scroll;margin:calc(0.666 * var(--spacing-vertical)) 0;padding:0;}.page-body pre code{background:none;padding:0;}.page-body hr{border:none;border-top:2px solid var(--color-border);width:calc(6 * var(--spacing-horizontal));margin:calc(0.666 * var(--spacing-vertical)) auto;}.blog-list{list-style:none;padding:0;}.blog-list li{margin-top:calc(0.666 * var(--spacing-vertical));margin-bottom:calc(0.666 * var(--spacing-vertical));}.blog-list li a{font-family:var(--font-heading);font-size:28px;font-weight:normal;line-height:1.3;color:var(--color-primary);text-decoration:underline;text-decoration-color:var(--color-secondary);text-decoration-thickness:1px;text-underline-offset:2px;}.blog-list li a:hover{color:var(--color-secondary);}.blog-list .date{display:block;color:var(--color-foreground-low-contrast);font-family:var(--font-heading);font-size:14px;margin-top:4px;}.back-link{display:inline-block;font-size:14px;color:var(--color-primary);text-decoration:underline;text-decoration-color:var(--color-secondary);margin-bottom:var(--spacing-vertical);}.back-link:hover{color:var(--color-secondary);}.back-link::before{content:'\2190\00a0';}footer{padding:var(--spacing-vertical) calc(2 * var(--spacing-horizontal));max-width:var(--content-width);margin:0 auto;color:var(--color-foreground);font-family:var(--font-heading);font-size:16px;}@media (max-width:600px){nav{padding:var(--spacing-unit) var(--spacing-horizontal);}.home-content{flex-wrap:wrap;padding:0 var(--spacing-horizontal);}.home-content .col-image{flex:0 0 100%;max-width:90%;}.home-content .col-text{flex:0 0 100%;max-width:100%;}.page{padding:0 var(--spacing-horizontal) var(--spacing-vertical);}.blog-list li a{font-size:24px;}}</style>
</head>
<body>
  <nav>
      <a href="/">Home</a>
      <a href="/now/">Now</a>
      <a href="/blog/">Blog</a>
      <a href="https://davideradaelli.substack.com/" target="_blank">Updates</a>
      <span class="social-icons">
        <a href="https://twitter.com/daviderady" target="_blank" aria-label="Twitter"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.23,5.924c-0.736,0.326-1.527,0.547-2.357,0.646c0.847-0.508,1.498-1.312,1.804-2.27 c-0.793,0.47-1.671,0.812-2.606,0.996C18.324,4.498,17.257,4,16.077,4c-2.266,0-4.103,1.837-4.103,4.103 c0,0.322,0.036,0.635,0.106,0.935C8.67,8.867,5.647,7.234,3.623,4.751C3.27,5.357,3.067,6.062,3.067,6.814 c0,1.424,0.724,2.679,1.825,3.415c-0.673-0.021-1.305-0.206-1.859-0.513c0,0.017,0,0.034,0,0.052c0,1.988,1.414,3.647,3.292,4.023 c-0.344,0.094-0.707,0.144-1.081,0.144c-0.264,0-0.521-0.026-0.772-0.074c0.522,1.63,2.038,2.816,3.833,2.85 c-1.404,1.1-3.174,1.756-5.096,1.756c-0.331,0-0.658-0.019-0.979-0.057c1.816,1.164,3.973,1.843,6.29,1.843 c7.547,0,11.675-6.252,11.675-11.675c0-0.178-0.004-0.355-0.012-0.531C20.985,7.47,21.68,6.747,22.23,5.924z"/></svg></a>
        <a href="https://www.youtube.com/channel/UCmYjuQS6o5-F9sqX8Pwvsiw" target="_blank" aria-label="YouTube"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.8,8.001c0,0-0.195-1.378-0.795-1.985c-0.76-0.797-1.613-0.801-2.004-0.847c-2.799-0.202-6.997-0.202-6.997-0.202 h-0.009c0,0-4.198,0-6.997,0.202C4.608,5.216,3.756,5.22,2.995,6.016C2.395,6.623,2.2,8.001,2.2,8.001S2,9.62,2,11.238v1.517 c0,1.618,0.2,3.237,0.2,3.237s0.195,1.378,0.795,1.985c0.761,0.797,1.76,0.771,2.205,0.855c1.6,0.153,6.8,0.201,6.8,0.201 s4.203-0.006,7.001-0.209c0.391-0.047,1.243-0.051,2.004-0.847c0.6-0.607,0.795-1.985,0.795-1.985s0.2-1.618,0.2-3.237v-1.517 C22,9.62,21.8,8.001,21.8,8.001z M9.935,14.594l-0.001-5.62l5.404,2.82L9.935,14.594z"/></svg></a>
      </span>
  </nav>

  <main><article class="page">
    <div class="page-header">
      <h1>An Intuitive Explanation of NLP Model ERNIE 2.0</h1>
      <p class="meta">September 16, 2019</p>
    </div>
    <div class="page-body">
      <p>Even though <a href="https://arxiv.org/abs/1907.12412">ERNIE 2.0 came out</a> for what feels in ML like a long time ago, it’s still an excellent model to look at to understand the larger context of NLP.</p>

<p>Natural language processing (NLP) has been a leading sub-field of machine learning, with pre-trained networks showing dominant results in various language understanding tasks. My goal is to explain ERNIE 2.0 with the goal of providing a solid framework for understanding the newest developments in natural language processing.</p>

<h3>The Big Dilemma of NLP</h3>

<p>In regular supervised neural networks, data is labeled and used to mathematically adjust the parameters of the neurons to maximize performance. But in NLP, a dilemma is presented where near-endless amounts of non-labeled information exist on the internet in the form of articles, encyclopedias, news, dialog and other language data available, but cannot be used when applying traditional techniques. This has led to a surge in research to find new ways of extracting as much useful information from unlabeled data as possible, in particular by employing co-occurrence probability — the chance words appear beside one another — in a technique called unsupervised learning. After reviewing massive amounts of unlabelled data in a period called pretraining, a more thorough supervised phase of learning called ‘fine-tuning’ takes place, which uses smaller labeled datasets to finalize training and specialize the network in tasks like:</p>

<ul>
<li>Sentiment analysis</li>
<li>Name-entity recognition</li>
<li>Question answering</li>
<li>Translation</li>
</ul>

<p>This pretraining section is largely responsible for many of the advancements in NLP.</p>

<h2>Core Ideas of ERNIE 2.0</h2>

<p>The researchers propose a new pre-training architecture called ERNIE 2.0 which allowed them to achieve state-of-the-art results.</p>

<h4>Idea 1: Increase information extraction from the unlabeled data during the unsupervised phase of learning.</h4>

<p>Problem: Current pre-training procedures usually focus on pre-training the model with several simple tasks to grasp the co-occurrence of words and sentences. However, besides co-occurring, there exists other valuable information that can be extracted from the data that is being left behind.</p>

<p>Solution: The researchers propose expanding pre-training tasks to include more than just co-occurrence of words and sentences, but also tasks like:</p>

<ul>
<li>A letter capitalization prediction task, in which the network is shown certain words like ‘paris’ and ‘cat’ and asked which one should be capitalized, in this case being ‘Paris’.</li>
<li>A document-word relationship pattern, where a sentence like: ‘Cats are predominantly active in the night’ is shown, and the document is asked which word is most likely to be repeated in other parts of the same article, the answer to this example being ‘cat’.</li>
<li>A sentence reordering task to learn the relationship among sentences. The sentences of a paragraph are split and shuffled randomly. The network is then asked to piece it back together as a paragraph.</li>
</ul>

<h4>Idea 2: Reduce the loss of learned progress when changing tasks.</h4>

<p>Problem: Current pre-training architectures tend to forget information when moving on from a task to another. Like when a ship is leaking from multiple holes, a network will go and adjust parameters to satisfy the first task — plug the leak — and then when encountering the second task it will adjust its parameters, causing it to perform well on the new task but at a risk of unlearning information gained previously — Like moving the same hand from the first leak to the second, causing the first to leak once more.</p>

<p>Solution: The researchers propose the use of a technique called: multi-task learning, in which during the unsupervised phase of the training, tasks are introduced incrementally in a way that penalizes ‘unlearning’ information. Specifically, the network is asked to:</p>

<ol>
<li>Perform and adjust parameters to maximize results on Task 1.</li>
<li>Perform and adjust parameters to maximize results on Task 1 and Task 2 at the same time.</li>
<li>Perform and adjust parameters to maximize results on Task 1, Task 2 and Task 3 at the same time.</li>
</ol>

<p>The story of NLP is in large part the story of effective pretraining on the massive amounts of language data available online. ERNIE 2.0 was more effective because it expanded the definition of pre-training tasks, and reduced the loss of learned progress by using multi-tasking.</p>
    </div>
  </article></main>

<script>if('serviceWorker'in navigator)navigator.serviceWorker.getRegistrations().then(rs=>rs.forEach(r=>r.unregister()))</script>
<script type="speculationrules">{"prefetch":[{"where":{"href_matches":"/*"},"eagerness":"moderate"}]}</script>
</body>
</html>